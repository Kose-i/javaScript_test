<html>
  <head>
    <script type="text/javascript">
      function isLeap(year)
      {
        if (year % 4 == 0 && (year% 400 = 0 || year %100 != 0)) {
          return true;
        }
        return false;
      }
      function calcFirstDay(date)
      {
        var tmpDate = new Date();
        tmpDate.setTime(date.getTime());
        tmpDate.setDate(1);
        return tmpDate.getDay();
      }
      function calcMonthDays(date)
      {
        var monthDays = new Array(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31);
        if (isLeapYear(date.getFullYear())) {
          monthDays[1] = 29;
        }
        return monthDays[date.getMonth()];
      }

      function display(today, month, firstDay, Days)
      {
        variStr;
        document.write("<h3>*", today.getFullYear(), "年");
        document.write(month+1, "月のカレンダー</h3>");
        document.write("<table style=\"text-align:right;font-size:24pt\">");
        document.write("<tr>");
        document.write("<th>日<th>月<th>火<th>水<th>木<th>金<th>土");
        document.write("</tr>");
        document.write("<tr>");
        var col = 0;
        for (var i = 0;i <firstDay;++i) {
          document.write("<td></td>");
          ++col;
        }
        for (var i = 1;i <= Days;++i) {
          document.write("<td>");

          if (i == today.getDate()) {
            iStr = i.toString().fontcolor("red");
            document.write(iStr+"</td>");
          } else {
            document.write(i+"</td>");
          }
          ++col;
          if (col == 7) {
            document.write("</tr><tr>");
            col = 0;
          }
        }
        document.write("</tr></table>");
      }
    </script>
  </head>
  <body>
    <script type="text/javascript">
      var today = new Date();
      var month = today.getMonth();
      var firstDay = calcFirstDay(today);
      var Days = calcMonthDays(today);

      display(today, month, firstDay, Days);
    </script>
  </body>
</html>
